{"paragraphs":[{"text":"%pyspark\nimport sys\nfrom pyspark.context import SparkContext\nfrom awsglue.context import GlueContext\nfrom awsglue.transforms import *\n\n# Create a Glue context\nglueContext = GlueContext(SparkContext.getOrCreate())\n\n# Create a Glue context\nglueContext = GlueContext(SparkContext.getOrCreate())\n\n# Create a DynamicFrame using the 'users' table\npatients = glueContext.create_dynamic_frame.from_catalog(database = \"rds-catalog\", table_name = \"oltp_public_patients\",\n                                                       transformation_ctx = \"patients\")\n\ninput = glueContext.create_dynamic_frame.from_catalog(database=\"s3catalogdb\", table_name=\"input_data_csv\",\n                                                       transformation_ctx=\"input\")\n\npatients_dob = Join.apply(input, patients, \"dob\", \"dob\")\n\npatients_dob.toDF().show()\n\npatients_ssn = Join.apply(input, patients, \"ssn\", \"ssn\")\n\npatients_ssn.toDF().show()\n\npatients_ssn.toDF().subtract(patients_dob.toDF()).show()","user":"anonymous","dateUpdated":"2019-04-07T19:38:28-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554661764981_-1685444618","id":"20190407-142924_1906776879","dateCreated":"2019-04-07T14:29:24-0400","dateStarted":"2019-04-07T15:20:32-0400","dateFinished":"2019-04-07T15:20:33-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2874","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------+---------+----------+----------+---------+---------+---+\n|first_name|      ssn|      .dob|       dob|     .ssn|last_name| id|\n+----------+---------+----------+----------+---------+---------+---+\n|     Alexa|940652095|1974-06-13|1974-06-13|940652095|  Lambert| 13|\n+----------+---------+----------+----------+---------+---------+---+\n\n+----------+---------+----------+----------+---------+---------+---+\n|first_name|      ssn|      .dob|       dob|     .ssn|last_name| id|\n+----------+---------+----------+----------+---------+---------+---+\n|     Alexa|940652095|1974-06-13|1974-06-13|940652095|  Lambert| 13|\n|    Alyssa|381347399|1913-10-13|2013-05-10|381347399|     Rosa| 14|\n+----------+---------+----------+----------+---------+---------+---+\n\n"}]}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2019-04-07T15:09:59-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python","tableHide":false,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1554661781112_-1041380416","id":"20190407-142941_1732091249","dateCreated":"2019-04-07T14:29:41-0400","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2875"}],"name":"legislators","id":"2E972FFM2","angularObjects":{"2E81DKTEK:shared_process":[],"2E6WPNZ3T:shared_process":[],"2EAR5YB9J:shared_process":[],"2E6YANA1V:shared_process":[],"2E88AHJ2W:shared_process":[],"2EARTPBKB:shared_process":[],"2E6WUJ69W:shared_process":[],"2EA5GJUTM:shared_process":[],"2E9HAQ2GB:shared_process":[],"2E8E6NYAT:shared_process":[],"2E7MFN1GN:shared_process":[],"2E899XZ64:existing_process":[],"2E9K3EZ2S:shared_process":[],"2E8G98UEK:shared_process":[],"2E746GG1R:shared_process":[],"2E9YTSDEF:shared_process":[],"2E8WYYBBH:shared_process":[],"2EA7YG3VP:shared_process":[],"2E8HK4U7K:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}